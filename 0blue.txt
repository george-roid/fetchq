window.stopZeroCounter = false; // Set to true to stop at any time

async function collectZeroGuyLinksLive(maxLinks = 1000, scrollDelay = 1500) {
    let zeroGuyLinks = new Set();
    let lastHeight = 0;
    let attemptsWithoutNew = 0;

    console.log("Started collecting. Set window.stopZeroCounter = true in the console to stop at any time.");

    while (zeroGuyLinks.size < maxLinks && attemptsWithoutNew < 10 && !window.stopZeroCounter) {
        let foundThisRound = 0;

        // Find all .ibar-opcounters on the page
        let spans = Array.from(document.querySelectorAll('span.ibar-opcounters'));
        spans.forEach(span => {
            let guyA = span.querySelector('a[href*="#guys"]');
            if (guyA) {
                let counter = guyA.querySelector('.guycounter');
                if (counter && counter.textContent.trim() === "0") {
                    let link = guyA.href.replace(/#guys$/, '');
                    if (!zeroGuyLinks.has(link)) {
                        zeroGuyLinks.add(link);
                        foundThisRound++;
                    }
                }
            }
        });

        if (foundThisRound > 0) {
            console.log(`[${zeroGuyLinks.size}] links collected so far... (+${foundThisRound} new)`);
        } else {
            console.log(`[${zeroGuyLinks.size}] links collected so far...`);
        }

        // Scroll and wait
        window.scrollTo(0, document.body.scrollHeight);
        await new Promise(res => setTimeout(res, scrollDelay));

        let newHeight = document.body.scrollHeight;
        if (newHeight === lastHeight) {
            attemptsWithoutNew++;
        } else {
            attemptsWithoutNew = 0;
            lastHeight = newHeight;
        }
    }

    let result = Array.from(zeroGuyLinks).slice(0, maxLinks);
    window.latestZeroGuyLinks = result;
    console.log(`Done! Collected ${result.length} links. To copy: copy(window.latestZeroGuyLinks.join("\\n"))`);
    return result;
}

// Usage:
collectZeroGuyLinksLive(1000, 1500);
